# å¤©æ¢AutoOpsè¿ç»´ç®¡ç†ç³»ç»Ÿ

## é¡¹ç›®ç®€ä»‹

å¤©æ¢AutoOpsè¿ç»´ç®¡ç†ç³»ç»Ÿ(æ¢=æ¢çº½+ä¸­å¿ƒ)æ˜¯ä¸€ä¸ªåŸºäº Go + vue3 æ¡†æ¶å¼€å‘çš„ä¼ä¸šçº§è¿ç»´è‡ªåŠ¨åŒ–å¹³å°ï¼Œæä¾›ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ä¸»æœºç®¡ç†ã€é…ç½®ä¸­å¿ƒã€ä»»åŠ¡è°ƒåº¦ã€K8sé›†ç¾¤ç®¡ç†ã€ç›‘æ§å‘Šè­¦ç­‰åŠŸèƒ½æ¨¡å—ã€‚ç»Ÿä¸€å¹³å°ï¼Œå…¨æ ˆæ²»ï¼šæ‰“ç ´ CI/CDã€ç›‘æ§ã€CMDBã€K8sã€å·¥å•ç­‰ç³»ç»Ÿå­¤å²›ï¼Œæ•°æ®äº’é€šã€ç­–ç•¥ç»Ÿ. æœ€ç»ˆå®ç°æŠŠå¸¸ç”¨çš„è¿ç»´å·¥å…·å…¨éƒ¨é›†æˆåœ¨ä¸€èµ·ï¼Œæ¯”å¦‚å¤œèºï¼Œjenkinsï¼Œjumpserverï¼Œkuboardï¼Œcmdbï¼ŒArcheryï¼Œç­‰ç­‰ï¼Œå®ç°è¿ç»´è‡ªåŠ¨åŒ–ã€‚
![alt text](assets/jg.png)

## åŠŸèƒ½æ¸…å•


| åŠŸèƒ½æ¨¡å— | åŠŸèƒ½é¡¹ | çŠ¶æ€ |
|---------|--------|------|
| **CMDBèµ„äº§ç®¡ç†** | ä¸»æœºç®¡ç† | âœ… |
| | ä¸»æœºç®¡ç†-é˜¿é‡Œ-è…¾è®¯-ç™¾åº¦-åä¸º-è·³æ¿æœº | âœ… |
| | äº‘å¯†é’¥ç®¡ç† | âœ… |
| | ä¸»æœºç»ˆç«¯ç®¡ç† | âœ… |
| | äº”ç±»æ•°æ®åº“ç®¡ç†(MySQL/PgSQL/Redis/ES/MongoDB) | âœ… |
| | windos ä¸»æœºç®¡ç† | ğŸš§è§„åˆ’ä¸­ |
| | windos è¿œç¨‹æ¡Œé¢-guacamole | ğŸš§è§„åˆ’ä¸­ |
| | äº¤æ¢æœºé…ç½®ç®¡ç†  | ğŸš§è§„åˆ’ä¸­ |
| **Kubernetesé›†ç¾¤ç®¡ç†** | å¤šé›†ç¾¤ç®¡ç† | âœ… |
| | èŠ‚ç‚¹ç®¡ç† | âœ… |
| | Podå®¹å™¨ç®¡ç† | âœ… |
| | å®¹å™¨é…ç½®-å­˜å‚¨-é…ç½®-ç½‘ç»œ-è·¯ç”±ç®¡ç† | âœ… |
| | K8sç›‘æ§åŠŸèƒ½ | ğŸš§ è§„åˆ’ä¸­ |
| | K8sé›†ç¾¤HPAè‡ªåŠ¨æ‰©ç¼©å®¹ | ğŸš§ è§„åˆ’ä¸­ |
| | K8sé›†ç¾¤ä¸€é”®éƒ¨ç½²  | ğŸš§ è§„åˆ’ä¸­ |
| **æœåŠ¡ç®¡ç†** | åº”ç”¨ç®¡ç† | âœ… |
| | åº”ç”¨å¿«é€Ÿå‘å¸ƒ-å¯¹æ¥Jenkinså¯è§†åŒ–å¿«é€Ÿå‘å¸ƒ | âœ… |
| | åº”ç”¨å·¥å•ä¸Šçº¿æµç¨‹å‘å¸ƒ | âœ… |
| | åº”ç”¨è„šæœ¬ä¸Šçº¿å·¥å• | âœ… |
| | åº”ç”¨ç®¡ç†å…¨å±€è§†å›¾ | ğŸš§ å¼€å‘ä¸­ |
| **ç›‘æ§ä¸­å¿ƒ** | åŸŸåç›‘æ§ | âœ… |
| | ä¸»æœºåŸºç¡€èµ„æºç›‘æ§ | âœ… |
| | ä¸»æœºå‘Šè­¦ | ğŸš§ å¼€å‘ä¸­ |
| | æ•…éšœç®¡ç† | âœ… |
| | æ•°æ®åº“å‘Šè­¦ | ğŸš§ å¼€å‘ä¸­ |
| | å‘Šè­¦æ¨é€ | ğŸš§ å¼€å‘ä¸­ |
| | åŸŸåSSLè¯ä¹¦ç”³è¯· | ğŸš§ å¼€å‘ä¸­ |
| **ä»»åŠ¡ä¸­å¿ƒ** | å®šæ—¶ä»»åŠ¡ | âœ… |
| | æ™®é€šè„šæœ¬ä»»åŠ¡(Shell/Python) | âœ… |
| | Ansible Playbookä»»åŠ¡ | âœ… |
| **è¿ç»´å·¥å…·** | å¸¸ç”¨è¿ç»´èµ„æºå®‰è£… | âœ… |
| | Agentç›‘æ§å·¥å…·å®‰è£… | âœ… |
| **é…ç½®ä¸­å¿ƒ** | ä¸»æœºå‡­æ®ç®¡ç† | âœ… |
| | é€šç”¨èµ„æºè´¦å·ç®¡ç† | âœ… |
| | äº‘èµ„æºå¯†é’¥ç®¡ç† | âœ… |
| **æ“ä½œå®¡è®¡** | ç™»å½•æ—¥å¿—å®¡è®¡ | âœ… |
| | æ“ä½œæ—¥å¿—å®¡è®¡ | âœ… |
| | æ•°æ®åº“æ“ä½œå®¡è®¡ | âœ… |
| | ç»ˆç«¯å½•åƒå®¡è®¡ | ğŸš§ å¼€å‘ä¸­ |
| **ç³»ç»Ÿç®¡ç†** | ç”¨æˆ·ç®¡ç† | âœ… |
| | è§’è‰²ç®¡ç†-RBACæˆæƒ | âœ… |
| | èœå•ç®¡ç†-èœå•-è·¯ç”±-æŒ‰é’®æƒé™ç®¡ç† | âœ… |
| | éƒ¨é—¨ç®¡ç† | âœ… |
| | LDAPè®¤è¯é›†æˆç®¡ç† | âœ… |
| | é£ä¹¦-é’‰é’‰-å¾®ä¿¡-é‚®ä»¶é›†æˆ | ğŸš§ å¼€å‘ä¸­ |
| **åç»­å¼€å‘åŠŸèƒ½** | SQLå·¥å•ç³»ç»Ÿ | ğŸ“‹ è§„åˆ’ä¸­ |
| | è¿ç»´å·¥å•ç³»ç»Ÿ | ğŸ“‹ è§„åˆ’ä¸­ |
| | è¿ç»´å…¨å±€å·¡æ£€æŠ¥å‘Š | ğŸ“‹ è§„åˆ’ä¸­ |
| | ä¼˜åŒ–è¿ç»´ä»ªè¡¨ç›˜ | âœ… å®Œæˆ |
| | è¿ç»´çŸ¥è¯†åº“å¼€å‘-Markdownå†™å…¥-å±•ç¤º | ğŸ“‹ è§„åˆ’ä¸­ |
| | AIå¤§æ¨¡å‹åˆ†æåŠŸèƒ½ | ğŸ“‹ è§„åˆ’ä¸­ |


### ä¼˜åŠ¿å¯¹æ¯”

<details>
<summary><b>ğŸ” ç‚¹å‡»å±•å¼€ä¼˜åŠ¿å¯¹æ¯”è¯¦æƒ…</b></summary>

#### DevOpsè¿ç»´ç®¡ç†ç³»ç»Ÿä¼˜åŠ¿
âœ… **è½»é‡çº§** - å•ä½“åº”ç”¨ï¼Œéƒ¨ç½²ç®€å•ï¼Œèµ„æºå ç”¨å°‘
âœ… **å…¨æ ˆè¿ç»´** - åŒæ—¶ç®¡ç†ä¼ ç»Ÿä¸»æœºå’ŒK8sé›†ç¾¤ï¼Œæ— éœ€å¤šå¥—ç³»ç»Ÿ
âœ… **å¼€ç®±å³ç”¨** - å†…ç½®CMDBã€ä»»åŠ¡è°ƒåº¦ã€SQLå®¡è®¡ç­‰ä¼ä¸šçº§åŠŸèƒ½
âœ… **äºŒæ¬¡å¼€å‘å‹å¥½** - Goè¯­è¨€ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºå®šåˆ¶
âœ… **æˆæœ¬ä½** - æ— å•†ä¸šæˆæƒè´¹ç”¨ï¼Œé€‚åˆä¸­å°ä¼ä¸š
âœ… **ä¸­æ–‡å‹å¥½** - å›½å†…å¼€å‘ï¼Œæ–‡æ¡£å’Œæ”¯æŒæ›´è´´åˆå›½å†…ä½¿ç”¨ä¹ æƒ¯

## æ ¸å¿ƒç«äº‰åŠ›åˆ†æ
ä¸ä¼ ç»Ÿè¿ç»´å¹³å°ç›¸æ¯”ï¼Œæœ¬ç³»ç»Ÿåœ¨**è‡ªåŠ¨åŒ–ç¨‹åº¦**ã€**ä¸€ä½“åŒ–æ•´åˆ**ã€**å¯è§‚æµ‹æ€§**ã€**å®‰å…¨åˆè§„**ã€**æ‰©å±•æ€§ä¸æ™ºèƒ½åŒ–æ¼”è¿›**ç­‰ç»´åº¦å±•ç°æ˜¾è‘—ä¼˜åŠ¿ï¼š

---

### 1ï¸âƒ£ é«˜åº¦é›†æˆçš„ä¸€ä½“åŒ–æ¶æ„

| å¯¹æ¯”ç»´åº¦ | ä¼ ç»Ÿå¹³å° | DevOpsè¿ç»´ç®¡ç†ç³»ç»Ÿ |
|---------|---------|------------------|
| **ç³»ç»Ÿæ„æˆ** | å¤šä¸ªå­¤ç«‹å·¥å…·æ‹¼å‡‘ï¼ˆZabbix + Ansible + CMDBï¼‰ | ç»Ÿä¸€å¹³å°æ·±åº¦æ•´åˆ |
| **æ•°æ®æµè½¬** | æ•°æ®å‰²è£‚ï¼Œéœ€æ‰‹åŠ¨åŒæ­¥ | æ•°æ®æ‰“é€šï¼Œå®æ—¶è”åŠ¨ |
| **æ“ä½œä½“éªŒ** | å¤šç³»ç»Ÿåˆ‡æ¢ï¼Œæ“ä½œç¹ç | ä¸€ä¸ªç³»ç»Ÿç®¡å…¨éƒ¨ï¼ŒååŒé«˜æ•ˆ |
| **æ ¸å¿ƒä»·å€¼** | âŒ ä¿¡æ¯å­¤å²›ä¸¥é‡ | âœ… æ¶ˆé™¤ä¿¡æ¯å­¤å²›ï¼Œæå‡ååŒæ•ˆç‡ |

---

### 2ï¸âƒ£ é¢å‘äº‘åŸç”Ÿçš„æ·±åº¦æ”¯æŒ

| å¯¹æ¯”ç»´åº¦ | ä¼ ç»Ÿå¹³å° | DevOpsè¿ç»´ç®¡ç†ç³»ç»Ÿ |
|---------|---------|------------------|
| **æŠ€æœ¯æ ˆ** | èšç„¦ç‰©ç†æœº/è™šæ‹Ÿæœº | åŸç”Ÿæ”¯æŒKubernetes |
| **å®¹å™¨ç®¡ç†** | æ”¯æŒè–„å¼±æˆ–éœ€æ’ä»¶ | å¤šé›†ç¾¤ç®¡ç†ã€Pod/é…ç½®/ç½‘ç»œ/å­˜å‚¨å…¨è¦ç´ ç®¡æ§ |
| **å¼¹æ€§ä¼¸ç¼©** | æ‰‹åŠ¨æˆ–ç®€å•è„šæœ¬ | HPAè‡ªåŠ¨æ‰©ç¼©å®¹ï¼ˆè§„åˆ’ä¸­ï¼‰ |
| **æ ¸å¿ƒä»·å€¼** | âŒ äº‘åŸç”Ÿæ”¯æŒä¸è¶³ | âœ… è´´åˆç°ä»£å¾®æœåŠ¡ä¸å®¹å™¨åŒ–æ¶æ„ |

---

### 3ï¸âƒ£ å‘å¸ƒä¸å·¥å•æµç¨‹æ·±åº¦èåˆ

| å¯¹æ¯”ç»´åº¦ | ä¼ ç»Ÿå¹³å° | DevOpsè¿ç»´ç®¡ç†ç³»ç»Ÿ |
|---------|---------|------------------|
| **å‘å¸ƒæ–¹å¼** | æ‰‹åŠ¨è„šæœ¬æˆ–ç®€å•CI | Jenkinså¯è§†åŒ–å¿«é€Ÿå‘å¸ƒ |
| **å˜æ›´ç®¡æ§** | ç¼ºä¹å®¡æ‰¹æµç¨‹ | å·¥å•å®¡æ‰¹æµç¨‹ + è„šæœ¬ä¸Šçº¿å·¥å• |
| **å¯è¿½æº¯æ€§** | è®°å½•ä¸å®Œæ•´ | å…¨æµç¨‹å¯è§†åŒ– + æ“ä½œå®¡è®¡ |
| **æ ¸å¿ƒä»·å€¼** | âŒ å®¡æ‰¹ã€è¿½æº¯èƒ½åŠ›å¼± | âœ… å…¼é¡¾æ•æ·æ€§ä¸åˆè§„æ€§ |

---

### ğŸ“Š æ€»ç»“å¯¹æ¯”

```
ä¼ ç»Ÿè¿ç»´å¹³å°ç—›ç‚¹ï¼š
â”œâ”€ ğŸ”´ å·¥å…·ç¢ç‰‡åŒ– â†’ å¤šç³»ç»Ÿåˆ‡æ¢ï¼Œæ•°æ®å­¤å²›
â”œâ”€ ğŸ”´ æµç¨‹ä¸é—­ç¯ â†’ å‘å¸ƒã€å®¡æ‰¹ã€å®¡è®¡åˆ†ç¦»
â”œâ”€ ğŸ”´ äº‘åŸç”Ÿæ”¯æŒå¼± â†’ éš¾ä»¥é€‚é…å®¹å™¨åŒ–æ¶æ„
â””â”€ ğŸ”´ æ™ºèƒ½åŒ–ç¼ºå¤± â†’ ä¾èµ–äººå·¥ç»éªŒåˆ¤æ–­

DevOpsè¿ç»´ç®¡ç†ç³»ç»Ÿä¼˜åŠ¿ï¼š
â”œâ”€ ğŸŸ¢ ä¸€ä½“åŒ–è®¾è®¡ â†’ ç»Ÿä¸€å¹³å°ï¼Œæ•°æ®æ‰“é€š
â”œâ”€ ğŸŸ¢ äº‘åŸç”ŸåŸç”Ÿæ”¯æŒ â†’ K8sæ·±åº¦é›†æˆ
â”œâ”€ ğŸŸ¢ åˆè§„å®¡è®¡ â†’ å®Œæ•´æ“ä½œè¿½æº¯
â””â”€ ğŸŸ¢ æ™ºèƒ½åŒ–æ¼”è¿› â†’ AIOpsæŠ€æœ¯å‰ç»æ€§
```

> **ğŸ’¡ æ ¸å¿ƒå®šä½**ï¼šæ„å»º**é«˜æ•ˆã€å®‰å…¨ã€å¯æ‰©å±•ä¸”é¢å‘æœªæ¥**çš„æ–°ä¸€ä»£æ™ºèƒ½è¿ç»´ä¸­æ¢ï¼Œè¿œè¶…ä¼ ç»Ÿè¿ç»´å¹³å°çš„èƒ½åŠ›è¾¹ç•Œã€‚

### é€‚ç”¨åœºæ™¯å»ºè®®

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ |
|------|---------|
| ä¸­å°ä¼ä¸šæ··åˆç¯å¢ƒï¼ˆVM + K8sï¼‰ | **DevOpsè¿ç»´ç®¡ç†ç³»ç»Ÿ** |
| çº¯K8sç¯å¢ƒï¼Œé¢„ç®—å……è¶³ | KubeSphere æˆ– Rancher |
| å¤šäº‘å¤šé›†ç¾¤å¤§è§„æ¨¡éƒ¨ç½² | Rancher |
| å›½å†…ä¼ä¸šï¼Œæ³¨é‡äº‘åŸç”Ÿå®Œæ•´æ€§ | KubeSphere |
| å¿«é€Ÿä¸Šçº¿ï¼Œèµ„æºæœ‰é™ | **DevOpsè¿ç»´ç®¡ç†ç³»ç»Ÿ** |
| éœ€è¦ä¼ ç»Ÿè¿ç»´+å®¹å™¨åŒ–åŒè½¨å¹¶è¡Œ | **DevOpsè¿ç»´ç®¡ç†ç³»ç»Ÿ** |

</details>

### æµ‹è¯•ç¯å¢ƒ
https://deviops.cn/login
è´¦å·ï¼štest
å¯†ç ï¼š123456
### è§†é¢‘å®‰è£…ä½¿ç”¨ä»‹ç»
https://www.bilibili.com/video/BV179Wxz1Ez6/?vd_source=37f81c1b36b3818cbad621bcbe5c3e49
![alt text](assets/bç«™.png)


## å®‰è£…æ­¥éª¤
dockerä¸€é”®å®‰è£…
[dockeréƒ¨ç½²æ–‡æ¡£](docker/README.md)
#### æ‹‰å–é•œåƒ(å¯é€‰,é¦–æ¬¡éƒ¨ç½²ä¼šè‡ªåŠ¨æ‹‰å–)
```bash
docker pull crpi-aj3vgoxp9kzh2jx4.cn-hangzhou.personal.cr.aliyuncs.com/zhangfan_k8s/deviops-api:v1.0
docker pull crpi-aj3vgoxp9kzh2jx4.cn-hangzhou.personal.cr.aliyuncs.com/zhangfan_k8s/deviops-web:v1.0
docker pull crpi-aj3vgoxp9kzh2jx4.cn-hangzhou.personal.cr.aliyuncs.com/zhangfan_k8s/pushgateway:v1.9.0
docker pull crpi-aj3vgoxp9kzh2jx4.cn-hangzhou.personal.cr.aliyuncs.com/zhangfan_k8s/redis:7.0-alpine
docker pull crpi-aj3vgoxp9kzh2jx4.cn-hangzhou.personal.cr.aliyuncs.com/zhangfan_k8s/prometheus:v2.47.0
docker pull crpi-aj3vgoxp9kzh2jx4.cn-hangzhou.personal.cr.aliyuncs.com/zhangfan_k8s/mysql:8.0.33
```
AutoOps v2 ç‰ˆæœ¬æ›´æ–°æ–¹æ³•
```bash
#æ‹‰å–v2.0ç‰ˆæœ¬é•œåƒ
docker pull crpi-aj3vgoxp9kzh2jx4.cn-hangzhou.personal.cr.aliyuncs.com/zhangfan_k8s/deviops-api:v2.0
docker pull crpi-aj3vgoxp9kzh2jx4.cn-hangzhou.personal.cr.aliyuncs.com/zhangfan_k8s/deviops-web:v2.0
#åœæ­¢v1.0ç‰ˆæœ¬,åˆ é™¤æœ¬åœ°é•œåƒ
docker stop  devops-web devops-api  && docker rm  devops-web devops-api
docker rmi     IMAGE ID
#ä¿®æ”¹é•œåƒtagæ ‡ç­¾
docker tag  xxx/deviops-api:v2.0  xxxxx/deviops-api:v1.0
docker tag  xxx/deviops-web:v2.0  xxxxx/deviops-web:v1.0
#å¯åŠ¨æœåŠ¡
docker up -d #å¯åŠ¨æœåŠ¡
```

### ä¿®æ”¹é…ç½®æ–‡ä»¶
```bash
* git clone https://github.com/zhang1024fan/deviops.git
* cd  deviops/docker

vim  api/config.yaml

  # æœ¬åœ°ipåœ°å€(æ›¿æ¢ä¸ºå®é™…çš„å¤–ç½‘IPæˆ–åŸŸå)
  imageHost: "http://192.168.2.123:8088"
# ç›‘æ§é…ç½®
monitor:
  prometheus:
    url: "http://192.168.2.123:9090"
  pushgateway:
    url: "http://192.168.2.123:9091"
  agent:
    heartbeat_server_url: "http://192.168.2.123:8000/api/v1/monitor/agent/heartbeat"
```

```bash
docker-compose up -d
### 2. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
### 3. æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs -f
### 4.è®¿é—®æœåŠ¡
Web å‰ç«¯: http://localhost:8088
é»˜è®¤è´¦å·: admin / 123456
```
### å‡çº§è¯´æ˜
1. ç›®å‰æ›´æ–°ä¼šæ›¿æ¢åŸæ¥çš„é•œåƒã€‚
2. åˆ é™¤æœ¬åœ°çš„é•œåƒã€‚docker stop  deviops-api  deviops-web  && docker rm  deviops-api  deviops-web
3. docker-compose up -d  #ä¼šé‡æ–°æ‹‰å–æœ€æ–°é•œåƒ


## æ„Ÿè°¢ä»¥ä¸‹åŒå­¦å¯¹æœ¬é¡¹ç›®æä¾›çš„æ‰“èµ

<p align="center">
  <img src="assets/image.png" width="120" />
  <img src="assets/image-1.png" width="120" />
  <img src="assets/image-2.png" width="120" />
  <img src="assets/image-3.png" width="120" />
  <img src="assets/image-4.png" width="120" />
  <img src="assets/image-5.png" width="120" />
  <img src="assets/image-6.png" width="120" />
  <img src="assets/image-7.png" width="120" />
  <img src="assets/image-8.png" width="120" />
</p>

## è”ç³»ä½œè€…

## æŠ€æœ¯äº¤æµ+ç¤¾åŒº

<img src="assets/zf.jpg" width="300" />

#### åŠ ç¾¤æŠ€æœ¯äº¤æµ
